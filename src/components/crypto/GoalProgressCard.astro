---
import type { GoalStats } from "@/lib/crypto";
import { formatCurrency, formatCurrencyWhole } from "@/lib/format";

interface Props {
  stats: GoalStats;
}

const { stats } = Astro.props as Props;

const milestoneCopy =
  stats.remainingToGoal > 0
    ? `${formatCurrency(stats.remainingToGoal)} more to reach the current milestone.`
    : "Goal reached â€” time to raise the target!";
---

<div
  class="mt-6 bg-zinc-900/30 rounded-xl border border-white/5 p-5 shadow-sm ring-1 ring-white/10"
>
  <div
    class="flex flex-col gap-2 md:flex-row md:items-center md:justify-between"
  >
    <div>
      <p class="text-xs uppercase tracking-widest text-zinc-500">
        10-year accumulation goal
      </p>
      <h4 class="text-2xl font-semibold">
        Road to {formatCurrencyWhole(stats.longTermGoal)}
      </h4>
    </div>
    <p class="text-sm text-zinc-400">
      {formatCurrency(stats.totalCurrentValue)} -{" "}
      {stats.goalProgressPercent.toFixed(1)}% complete
    </p>
  </div>
  <div class="mt-4 h-3 rounded-full bg-zinc-800 overflow-hidden">
    <div
      class="h-full bg-gradient-to-r from-yellow-500 to-orange-500"
      style={`width: ${stats.goalProgressPercent}%`}
    >
    </div>
  </div>
  <p class="mt-2 text-xs text-zinc-400">{milestoneCopy}</p>
  <p class="mt-1 text-xs text-zinc-500">
    {stats.daysInvested} days into the plan - roughly{" "}
    {formatCurrency(stats.monthlyContribution)} per month (
    {formatCurrency(stats.yearlyContribution)} yearly) on autopilot.
  </p>
  <p class="mt-1 text-xs text-zinc-500">
    Linear projection pushes the portfolio toward{" "}
    {formatCurrency(stats.projectedYearEndValue)} by year end if the DCA pace stays
    steady.
  </p>
</div>
